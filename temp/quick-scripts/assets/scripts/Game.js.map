{"version":3,"sources":["Game.js"],"names":["cc","Class","extends","Component","properties","bgm","default","type","AudioClip","title","Node","bgs","gameTimer","Label","gameCamera","Camera","starNumber","currentStarNumber","currentStars","mostHit","starPrefab","Prefab","redStarPrefab","scoreFXPrefab","rankList","ground","player","twiceJumpGetScore","scoreKeeper","scoreDisplay","farCameraAudio","scoreAudio","menuNode","gameOverNode","youWinNode","controlHintLabel","keyboardHint","multiline","touchHint","winScoreLabel","gameWinAudio","gameOverAudio","onLoad","audioEngine","playEffect","redStar","timeKeeper","menuToFirstPanel","iniBg","groundY","y","height","currentStarX","enabled","string","sys","isMobile","starPool","NodePool","scorePool","initGame","iniStarDuration","starDuration","gameLevel","cameraFarSpeed","starMoreSpeed","time","score","zoomRatio","startGame","active","startGameTimer","resetScore","getComponent","startMoveAt","spawnNewStar","spawnRedStar","menuHideAll","c","children","i","menuToAttribute","menuToShop","menuToGuide","menuToRank","axios","get","then","console","log","response","data","catch","error","menuToAbout","zIndex","scale","bgChildren","l","length","Math","floor","random","setInterval","toFixed","bind","stopGameTimer","clearInterval","instantiate","node","addChild","destHeight","randY","jumpHeight","randX","width","setPosition","v2","init","t","rising","setTimeout","newStar","size","getNewStarPosition","startTimer","push","despawnStar","star","destroy","timer","maxX","gainScore","pos","fx","spawnScoreFX","theScoreShow","_components","_string","play","despawnScoreFX","scoreFX","put","gameUpgrade","farBg","times","modify","farCamera","update","dt","gameOver","gameWin","finalScore","pow","again","sendScore","stopMove","clear","post"],"mappings":"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","file":"Game.js","sourceRoot":"..\\..\\..\\..\\assets\\scripts","sourcesContent":["import axios from 'axios';\n\n\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n\n    \tbgm:{\n    \t\tdefault:null,\n    \t\ttype: cc.AudioClip\n    \t},\n\n        title:{\n            default:null,\n            type:cc.Node\n        },\n\n        bgs:{\n            default:null,\n            type:cc.Node\n        },\n        gameTimer:{\n            default:null,\n            type: cc.Label\n        },\n\n        gameCamera:{\n            default:null,\n            type:cc.Camera\n        },\n        starNumber:1,\n        currentStarNumber:1,\n        currentStars:[],\n        mostHit:0,\n\n        // 这个属性引用了星星预制资源\n        starPrefab: {\n            default: null,\n            type: cc.Prefab\n        },\n        redStarPrefab: {\n            default: null,\n            type: cc.Prefab\n        },\n        scoreFXPrefab: {\n            default: null,\n            type: cc.Prefab\n        },\n\n        rankList:{\n            default: null,\n            type: cc.Label\n        },\n        // 地面节点，用于确定星星生成的高度\n        ground: {\n            default: null,\n            type: cc.Node\n        },\n        // player 节点，用于获取主角弹跳的高度，和控制主角行动开关\n        player: {\n            default: null,\n            type: cc.Node\n        },\n        twiceJumpGetScore:0,\n        scoreKeeper:1,\n        // score label 的引用\n        scoreDisplay: {\n            default: null,\n            type: cc.Label\n        },\n\n        farCameraAudio:{\n            default: null,\n            type: cc.AudioClip\n        },\n        // 得分音效资源\n        scoreAudio: {\n            default: null,\n            type: cc.AudioClip\n        },\n\n        menuNode: {\n            default: null,\n            type: cc.Node\n        },\n        gameOverNode: {\n            default: null,\n            type: cc.Node\n        },\n        youWinNode: {\n            default: null,\n            type: cc.Node\n        },\n        controlHintLabel: {\n            default: null,\n            type: cc.Label\n        },\n        keyboardHint: {\n            default: '',\n            multiline: true\n        },\n        touchHint: {\n            default: '',\n            multiline: true\n        },\n        winScoreLabel :{\n            default:null,\n            type: cc.Label\n        },\n        gameWinAudio: {\n            default: null,\n            type: cc.AudioClip\n        },\n        gameOverAudio: {\n            default: null,\n            type: cc.AudioClip\n        },\n    },\n\n    onLoad () {\n\n        cc.audioEngine.playEffect(this.bgm, true);\n\n    \tthis.redStar = null;\n        this.timeKeeper = null;\n\n    \tthis.menuToFirstPanel();\n        this.iniBg();\n\n        // 获取地平面的 y 轴坐标\n        this.groundY = this.ground.y + this.ground.height/2 - 10;\n\n        // store last star's x position\n        this.currentStarX = 0;\n\n        // is showing menu or running game\n        this.enabled = false;\n\n        // initialize control hint\n        this.controlHintLabel.string = \"操作说明：\\n\"+(cc.sys.isMobile ? this.touchHint : this.keyboardHint);\n\n        // initialize star and score pool\n        this.starPool = new cc.NodePool('Star');\n        this.scorePool = new cc.NodePool('ScoreFX');\n    },\n\n    initGame(){\n        this.iniStarDuration = 6;\n        this.starDuration = 0; \n        this.gameLevel = 0;\n        this.cameraFarSpeed = 10;  // 拉远镜头频率\n        this.starMoreSpeed = 30;   // 星星增加频率\n        this.time = 0;\n        this.score = 0;\n        this.scoreKeeper = 1,        \n        this.currentStarNumber = 1;\n        this.mostHit = 0;\n        this.starNumber = 1;\n        this.gameCamera.zoomRatio = 1;\n    },\n\n    startGame() {\n        \n        this.title.active = false;\n        this.initGame();\n        this.iniBg();\n        // 开始计时\n        this.startGameTimer();\n        // 初始化计分\n        this.resetScore();\n        // set game state to running\n        this.enabled = true;\n        // set button and gameover text out of screen\n        this.menuNode.active = false;\n        this.gameOverNode.active = false;\n        this.youWinNode.active = false;\n        // reset player position and move speed\n        this.player.getComponent('Player').startMoveAt(0,this.groundY);\n\n        this.spawnNewStar();\n        this.spawnRedStar();\n    },\n\n    // 关于菜单部分\n    menuHideAll(){\n    \tlet c = this.menuNode.children;\n    \tfor(let i of c){\n    \t\ti.active = false;\n    \t}\n    \treturn c;\n    },\n    menuToFirstPanel(){\n    \tlet c = this.menuHideAll();\n    \tc[0].active = true;\n    },\n    menuToAttribute(){\n    \tlet c = this.menuHideAll();\n    \tc[1].active = true;\n    },\n    menuToShop(){\n        let c = this.menuHideAll();\n        c[2].active = true;\n    },\n    menuToGuide(){\n        let c = this.menuHideAll();\n        c[3].active = true;\n    },\n    menuToRank(){\n        let c = this.menuHideAll();\n        c[4].active = true;\n        axios.get('/ranklist')\n        .then(response=>{\n            console.log(response);\n            this.rankList.string = response.data;\n        })\n        .catch(error=>{\n            console.log(error)\n        })\n    },\n    menuToAbout(){\n    \tlet c = this.menuHideAll();\n    \tc[5].active = true;\n    },\n\n\n\n\n    iniBg(){\n        this.bgs.zIndex = -10;\n\t\tthis.bgs.scale = 1;\n        console.log(this.bgs);\n        console.log(this.bgs.scale)\n        \n        let bgChildren = this.bgs.children;\n        let l = bgChildren.length;\n        for(let i of bgChildren){\n            i.active = false;\n        }\n        bgChildren[Math.floor(Math.random()*l)].active = true;\n    },\n\n    startGameTimer(){\n        this.timeKeeper = setInterval(function(){\n            this.time += 0.01;\n            this.gameTimer.string = \"Time: \" + this.time.toFixed(2); \n        }.bind(this),10);\n    },\n    stopGameTimer(){\n        clearInterval(this.timeKeeper);\n    },\n\n\n    spawnRedStar(){\n        this.redStar = cc.instantiate(this.redStarPrefab);\n        this.node.addChild(this.redStar);\n\n        let destHeight = this.node.height/2 - this.redStar.height/2;\n        let randY = this.groundY + this.player.getComponent('Player').jumpHeight + 120;\n        let randX = (Math.random() - 0.5) * 2 * (this.node.width/2 - this.redStar.height/2);\n        this.redStar.setPosition(cc.v2(randX, randY));\n        this.redStar.getComponent('RedStar').init(this);\n\n        let t = this;\n        (function rising(){\n            setTimeout(function(){\n                t.redStar.setPosition(cc.v2(randX, randY));\n                randY++;\n                if(randY<destHeight) rising();\n            },600);\n        })();\n    },\n\n    spawnNewStar() {\n        var newStar = null;\n        // 使用给定的模板在场景中生成一个新节点\n        if (this.starPool.size() > 0) {\n            newStar = this.starPool.get(this); // this will be passed to Star's reuse method\n        } else {\n            newStar = cc.instantiate(this.starPrefab);\n        }\n        \n        // 将新增的节点添加到 Canvas 节点下面\n        this.node.addChild(newStar);\n        // 为星星设置一个随机位置\n        newStar.setPosition(this.getNewStarPosition());\n        // pass Game instance to star\n        newStar.getComponent('Star').init(this);\n\n        // start star timer and store star reference\n        this.startTimer();\n        this.currentStars.push(newStar);\n    },\n\n    despawnStar (star) {\n        star.destroy();\n        this.currentStarNumber--;\n        //如果当前场景中没有星星\n        if(!this.currentStarNumber){\n            for(let i=0;i<this.starNumber;i++){\n                this.spawnNewStar();\n            }\n            this.currentStarNumber = this.starNumber;\n        }\n    },\n\n    startTimer () {\n        this.starDuration = this.iniStarDuration - this.gameLevel / 150;\n        this.timer = 0;\n    },\n\n    getNewStarPosition () {\n        // 根据地平面位置和主角跳跃高度，随机得到一个星星的 y 坐标\n        var randY = this.groundY + Math.random() * this.player.getComponent('Player').jumpHeight + 30;\n        // 根据屏幕宽度，随机得到一个星星 x 坐标\n        // var maxX = this.node.width/2 + this.gameLevel*0.3;\n        var maxX = this.node.width/2;\n        var randX = (Math.random() - 0.5) * 2 * maxX;\n        // 返回星星坐标\n        // return cc.v2(randX, randY);\n        return cc.v2(randX, randY);\n    },\n\n\n    gainScore (pos) {\n        this.score += this.scoreKeeper;\n        if(this.scoreKeeper > this.mostHit){\n        \tthis.mostHit = this.scoreKeeper;\n        }\n        // 更新 scoreDisplay Label 的文字\n        this.scoreDisplay.string = 'Score: ' + this.score;\n        \n        this.twiceJumpGetScore = 2;\n\n        // 播放特效\n        var fx = this.spawnScoreFX();\n        var theScoreShow = fx.node.children[0].children[1]._components[0];\n        theScoreShow._string = \"+\"+this.scoreKeeper;\n        this.node.addChild(fx.node);\n        fx.node.setPosition(pos);\n        fx.play();\n        \n        // 播放得分音效\n        cc.audioEngine.playEffect(this.scoreAudio, false);\n        this.scoreKeeper++;\n    },\n    resetScore () {\n        this.score = 0;\n        this.scoreDisplay.string = 'Score: ' + this.score;\n    },\n\n    spawnScoreFX () {\n        var fx;\n        fx = cc.instantiate(this.scoreFXPrefab).getComponent('ScoreFX');\n        fx.init(this);\n        return fx;\n    },\n\n    despawnScoreFX (scoreFX) {\n        this.scorePool.put(scoreFX);\n    },\n\n    gameUpgrade(){\n        this.gameLevel++;\n        if(this.gameLevel%this.cameraFarSpeed === 0){\n            // this.farCamera();\n            // 缩小背景图\n            // this.bgs.\n            this.farBg();\n            // console.log(this.bgs.scale)\n            // this.bgs.scale *= 0.9;\n        }\n        if(this.gameLevel < 21 && this.gameLevel%10 === 0){\n            this.starNumber ++;\n        }\n        if(this.gameLevel%this.starMoreSpeed === 0){\n            this.starNumber ++;\n            this.iniStarDuration += 0.7;\n        }\n    },\n\n    farBg(){\n        let times = 0;\n        // this.bgs.scale *= 0.9;\n        let modify = setInterval(function(){\n            this.bgs.scale *= (999 / 1000);\n            // this.gameCamera.zoomRatio *= (999 / 1000);\n            times++;\n            if(times==10){\n                clearInterval(modify);\n            }\n        }.bind(this),50)\n        cc.audioEngine.playEffect(this.farCameraAudio, false);\n    },\n\n    // 设置镜头\n    farCamera(){\n        let times = 0;\n        let modify = setInterval(function(){\n            this.gameCamera.zoomRatio *= (999 / 1000);\n            times++;\n            if(times==8){\n                clearInterval(modify);\n            }\n        }.bind(this),50)\n        cc.audioEngine.playEffect(this.farCameraAudio, false);\n\t},\n\n    update (dt) {\n        // 每帧更新计时器，超过限度还没有生成新的星星\n        // 就会调用游戏失败逻辑\n        if (this.timer > this.starDuration) {\n            this.gameOver();\n            this.enabled = false;   // disable gameOver logic to avoid load scene repeatedly\n            return;\n        }\n        this.timer += dt;\n    },\n\n    gameWin(){\n        this.finalScore = (Math.pow((300 / this.time.toFixed(2)),2).toFixed(2) * this.score).toFixed(1) * 10;\n        this.winScoreLabel.string = 'Final Score: '+ this.finalScore + '\\n' + \"Most Hit: \"+this.mostHit;\n        \n        // this.youWinNode.children[0]._components[0]._string = 'Final Score: '+ this.finalScore + '\\n' + \"Most Hit: \"+this.mostHit;\n        this.youWinNode.active = true;\n        this.again();\n        cc.audioEngine.playEffect(this.gameWinAudio, false); \n    },\n\n    gameOver () {\n        this.gameOverNode.active = true;\n        this.again();\n        cc.audioEngine.playEffect(this.gameOverAudio, false);\n    },\n\n    again(){\n        this.sendScore();\n        this.player.getComponent('Player').stopMove();\n        this.stopGameTimer();\n        this.menuNode.active = true;\n        this.enabled = false;\n        this.starPool.clear();\n        this.redStar.destroy();\n        for(let i of this.currentStars){\n            i.destroy();\n        }\n        this.currentStars = [];\n    },\n    sendScore(){\n        console.log(this.time);\n        console.log(this.score);\n        console.log(this.finalScore);\n        let data = {\n            // player:,\n            time:this.time,\n            score:this.score,\n            finalScore:this.finalScore\n        };\n        axios.post('/sendScore',data)\n        .then(response=>{\n            console.log(response)\n        })\n        .catch(error=>{\n            console.log(error)\n        })\n    }\n\n});"]}