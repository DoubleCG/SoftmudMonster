{"version":3,"sources":["..\\..\\..\\..\\assets\\scripts/assets\\scripts\\Game.js"],"names":["cc","Class","extends","Component","properties","bgm","default","type","AudioClip","title","Node","bgs","gameTimer","Label","gameCamera","Camera","starNumber","currentStarNumber","currentStars","mostHit","starPrefab","Prefab","redStarPrefab","scoreFXPrefab","ground","player","twiceJumpGetScore","scoreKeeper","scoreDisplay","farCameraAudio","scoreAudio","menuNode","gameOverNode","youWinNode","controlHintLabel","keyboardHint","multiline","touchHint","gameWinAudio","gameOverAudio","onLoad","audioEngine","playEffect","redStar","timeKeeper","menuToFirstPanel","iniBg","groundY","y","height","currentStarX","enabled","string","sys","isMobile","starPool","NodePool","scorePool","initGame","iniStarDuration","starDuration","gameLevel","cameraFarSpeed","starMoreSpeed","time","score","zoomRatio","startGame","active","startGameTimer","resetScore","getComponent","startMoveAt","spawnNewStar","spawnRedStar","menuHideAll","c","children","i","menuToAttribute","menuToGuide","menuToAbout","zIndex","bgChildren","l","length","Math","floor","random","setInterval","toFixed","bind","stopGameTimer","clearInterval","instantiate","node","addChild","destHeight","randY","jumpHeight","randX","width","setPosition","v2","init","t","rising","setTimeout","newStar","size","get","getNewStarPosition","startTimer","push","despawnStar","star","destroy","timer","maxX","gainScore","pos","fx","spawnScoreFX","theScoreShow","_components","_string","play","despawnScoreFX","scoreFX","put","gameUpgrade","farCamera","times","modify","update","dt","gameOver","gameWin","again","stopMove","clear"],"mappings":"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","file":"Game.js","sourceRoot":"..\\..\\..\\..\\assets\\scripts","sourcesContent":["cc.Class({\n    extends: cc.Component,\n\n    properties: {\n\n    \tbgm:{\n    \t\tdefault:null,\n    \t\ttype: cc.AudioClip\n    \t},\n\n        title:{\n            default:null,\n            type:cc.Node\n        },\n\n        bgs:{\n            default:null,\n            type:cc.Node\n        },\n        gameTimer:{\n            default:null,\n            type: cc.Label\n        },\n\n        gameCamera:{\n            default:null,\n            type:cc.Camera\n        },\n        starNumber:1,\n        currentStarNumber:1,\n        currentStars:[],\n        mostHit:0,\n\n        // 这个属性引用了星星预制资源\n        starPrefab: {\n            default: null,\n            type: cc.Prefab\n        },\n        redStarPrefab: {\n            default: null,\n            type: cc.Prefab\n        },\n        scoreFXPrefab: {\n            default: null,\n            type: cc.Prefab\n        },\n\n        // 地面节点，用于确定星星生成的高度\n        ground: {\n            default: null,\n            type: cc.Node\n        },\n\n        // player 节点，用于获取主角弹跳的高度，和控制主角行动开关\n        player: {\n            default: null,\n            type: cc.Node\n        },\n        twiceJumpGetScore:0,\n        scoreKeeper:1,\n        // score label 的引用\n        scoreDisplay: {\n            default: null,\n            type: cc.Label\n        },\n\n        farCameraAudio:{\n            default: null,\n            type: cc.AudioClip\n        },\n        // 得分音效资源\n        scoreAudio: {\n            default: null,\n            type: cc.AudioClip\n        },\n\n        menuNode: {\n            default: null,\n            type: cc.Node\n        },\n        gameOverNode: {\n            default: null,\n            type: cc.Node\n        },\n        youWinNode: {\n            default: null,\n            type: cc.Node\n        },\n        controlHintLabel: {\n            default: null,\n            type: cc.Label\n        },\n        keyboardHint: {\n            default: '',\n            multiline: true\n        },\n        touchHint: {\n            default: '',\n            multiline: true\n        },\n        gameWinAudio: {\n            default: null,\n            type: cc.AudioClip\n        },\n        gameOverAudio: {\n            default: null,\n            type: cc.AudioClip\n        },\n    },\n\n    onLoad () {\n\n\n        cc.audioEngine.playEffect(this.bgm, true);\n\n    \tthis.redStar = null;\n        this.timeKeeper = null;\n\n    \tthis.menuToFirstPanel();\n        this.iniBg();\n\n        // 获取地平面的 y 轴坐标\n        this.groundY = this.ground.y + this.ground.height/2 - 10;\n\n        // store last star's x position\n        this.currentStarX = 0;\n\n        // is showing menu or running game\n        this.enabled = false;\n\n        // initialize control hint\n        this.controlHintLabel.string = \"操作说明：\\n\"+(cc.sys.isMobile ? this.touchHint : this.keyboardHint);\n\n        // initialize star and score pool\n        this.starPool = new cc.NodePool('Star');\n        this.scorePool = new cc.NodePool('ScoreFX');\n    },\n\n    initGame(){\n        this.iniStarDuration = 6;\n        this.starDuration = 0; \n        this.gameLevel = 0;\n        this.cameraFarSpeed = 10;  // 拉远镜头频率\n        this.starMoreSpeed = 30;   // 星星增加频率\n        this.time = 0;\n        this.score = 0;\n        this.scoreKeeper = 1,        \n        this.currentStarNumber = 1;\n        this.mostHit = 0;\n        this.starNumber = 1;\n        this.gameCamera.zoomRatio = 1;\n    },\n\n    startGame() {\n        \n        this.title.active = false;\n        this.initGame();\n        this.iniBg();\n\n        // 开始计时\n        this.startGameTimer();\n        // 初始化计分\n        this.resetScore();\n        // set game state to running\n        this.enabled = true;\n        // set button and gameover text out of screen\n        this.menuNode.active = false;\n        this.gameOverNode.active = false;\n        this.youWinNode.active = false;\n        // reset player position and move speed\n        this.player.getComponent('Player').startMoveAt(0,this.groundY);\n\n        this.spawnNewStar();\n        this.spawnRedStar();\n    },\n\n    // 关于菜单部分\n    menuHideAll(){\n    \tlet c = this.menuNode.children;\n    \tfor(let i of c){\n    \t\ti.active = false;\n    \t}\n    \treturn c;\n    },\n    menuToFirstPanel(){\n    \tlet c = this.menuHideAll();\n    \tc[0].active = true;\n    },\n    menuToAttribute(){\n    \tlet c = this.menuHideAll();\n    \tc[1].active = true;\n    },\n    menuToGuide(){\n        let c = this.menuHideAll();\n        c[2].active = true;\n    },\n    menuToAbout(){\n    \tlet c = this.menuHideAll();\n    \tc[3].active = true;\n    },\n\n    iniBg(){\n        this.bgs.zIndex = -10;\n        let bgChildren = this.bgs.children;\n        let l = bgChildren.length;\n        for(let i of bgChildren){\n            i.active = false;\n        }\n        bgChildren[Math.floor(Math.random()*l)].active = true;\n    },\n\n    startGameTimer(){\n        this.timeKeeper = setInterval(function(){\n            this.time += 0.01;\n            this.gameTimer.string = \"Time: \" + this.time.toFixed(2); \n        }.bind(this),10);\n    },\n    stopGameTimer(){\n        clearInterval(this.timeKeeper);\n    },\n\n\n    spawnRedStar(){\n        this.redStar = cc.instantiate(this.redStarPrefab);\n        this.node.addChild(this.redStar);\n\n        let destHeight = 370;\n        let randY = this.groundY + this.player.getComponent('Player').jumpHeight + 120;\n        let randX = (Math.random() - 0.5) * 2 * this.node.width/2;\n        this.redStar.setPosition(cc.v2(randX, randY));\n        this.redStar.getComponent('RedStar').init(this);\n\n        let t = this;\n        (function rising(){\n            setTimeout(function(){\n                t.redStar.setPosition(cc.v2(randX, randY));\n                randY++;\n                if(randY<destHeight) rising();\n            },500);\n        })();\n    },\n\n    spawnNewStar() {\n        var newStar = null;\n        // 使用给定的模板在场景中生成一个新节点\n        if (this.starPool.size() > 0) {\n            newStar = this.starPool.get(this); // this will be passed to Star's reuse method\n        } else {\n            newStar = cc.instantiate(this.starPrefab);\n        }\n        \n        // 将新增的节点添加到 Canvas 节点下面\n        this.node.addChild(newStar);\n        // 为星星设置一个随机位置\n        newStar.setPosition(this.getNewStarPosition());\n        // pass Game instance to star\n        newStar.getComponent('Star').init(this);\n\n        // start star timer and store star reference\n        this.startTimer();\n        this.currentStars.push(newStar);\n    },\n\n    despawnStar (star) {\n        star.destroy();\n        this.currentStarNumber--;\n        //如果当前场景中没有星星\n        if(!this.currentStarNumber){\n            for(let i=0;i<this.starNumber;i++){\n                this.spawnNewStar();\n            }\n            this.currentStarNumber = this.starNumber;\n        }\n    },\n\n    startTimer () {\n        this.starDuration = this.iniStarDuration - this.gameLevel / 150;\n        this.timer = 0;\n    },\n\n    getNewStarPosition () {\n        // 根据地平面位置和主角跳跃高度，随机得到一个星星的 y 坐标\n        var randY = this.groundY + Math.random() * this.player.getComponent('Player').jumpHeight + 30;\n        // 根据屏幕宽度，随机得到一个星星 x 坐标\n        // var maxX = this.node.width/2 + this.gameLevel*0.3;\n        var maxX = this.node.width/2;\n        var randX = (Math.random() - 0.5) * 2 * maxX;\n        // 返回星星坐标\n        return cc.v2(randX, randY);\n    },\n\n\n    gainScore (pos) {\n        this.score += this.scoreKeeper;\n        if(this.scoreKeeper > this.mostHit){\n        \tthis.mostHit = this.scoreKeeper;\n        }\n        // 更新 scoreDisplay Label 的文字\n        this.scoreDisplay.string = 'Score: ' + this.score;\n        \n        this.twiceJumpGetScore = 2;\n\n        // 播放特效\n        var fx = this.spawnScoreFX();\n        var theScoreShow = fx.node.children[0].children[1]._components[0];\n        theScoreShow._string = \"+\"+this.scoreKeeper;\n        this.node.addChild(fx.node);\n        fx.node.setPosition(pos);\n        fx.play();\n        \n        // 播放得分音效\n        cc.audioEngine.playEffect(this.scoreAudio, false);\n        this.scoreKeeper++;\n    },\n    resetScore () {\n        this.score = 0;\n        this.scoreDisplay.string = 'Score: ' + this.score;\n    },\n\n    spawnScoreFX () {\n        var fx;\n        fx = cc.instantiate(this.scoreFXPrefab).getComponent('ScoreFX');\n        fx.init(this);\n        return fx;\n    },\n\n    despawnScoreFX (scoreFX) {\n        this.scorePool.put(scoreFX);\n    },\n\n    gameUpgrade(){\n        this.gameLevel++;\n        if(this.gameLevel%this.cameraFarSpeed === 0){\n            this.farCamera();\n        }\n        if(this.gameLevel < 21 && this.gameLevel%10 === 0){\n            this.starNumber ++;\n        }\n        if(this.gameLevel%this.starMoreSpeed === 0){\n            this.starNumber ++;\n            this.iniStarDuration += 0.7;\n        }\n    },\n\n    // 设置镜头\n    farCamera(){\n        let times = 0;\n        let modify = setInterval(function(){\n            this.gameCamera.zoomRatio *= (999 / 1000);\n            times++;\n            if(times==8){\n                clearInterval(modify);\n            }\n        }.bind(this),50)\n        cc.audioEngine.playEffect(this.farCameraAudio, false);\n\t},\n\n    update (dt) {\n        // 每帧更新计时器，超过限度还没有生成新的星星\n        // 就会调用游戏失败逻辑\n        if (this.timer > this.starDuration) {\n            this.gameOver();\n            this.enabled = false;   // disable gameOver logic to avoid load scene repeatedly\n            return;\n        }\n        this.timer += dt;\n    },\n\n    gameWin(){\n        this.youWinNode.children[0]._components[0]._string = 'Final Score: '+ ((300 / this.time.toFixed(2)).toFixed(2) * this.score).toFixed(1) * 10 + '\\n' + \"Most Hit: \"+this.mostHit;\n        this.youWinNode.active = true;\n        this.again();\n        cc.audioEngine.playEffect(this.gameWinAudio, false); \n    },\n\n    gameOver () {\n        this.gameOverNode.active = true;\n        this.again();\n        cc.audioEngine.playEffect(this.gameOverAudio, false);\n    },\n\n\n    again(){\n        this.player.getComponent('Player').stopMove();\n        this.stopGameTimer();\n        this.menuNode.active = true;\n        this.enabled = false;\n        this.starPool.clear();\n        this.redStar.destroy();\n        for(let i of this.currentStars){\n            i.destroy();\n        }\n        this.currentStars = [];\n    }\n\n});"]}