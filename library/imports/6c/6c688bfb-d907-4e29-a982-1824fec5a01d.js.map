{"version":3,"sources":["..\\..\\..\\..\\assets\\scripts/assets\\scripts\\Player.js"],"names":["cc","Class","extends","Component","properties","initialHeight","jumpHeight","jumpDuration","squashDuration","maxMoveSpeed","accel","jumpAudio","default","type","AudioClip","switchJumpStyleAudio","jumpInterval","jumpStyleIndex","jumpStylesLength","jumpStyleDisplay","Label","onLoad","enabled","initProperties","accLeft","accRight","xSpeed","minPosX","node","parent","width","maxPosX","systemEvent","on","SystemEvent","EventType","KEY_DOWN","onKeyDown","KEY_UP","onKeyUp","touchReceiver","Canvas","instance","onTouchStart","onTouchEnd","upgrade","updateJumpAction","getJumpStyles","r","styleKeys","styleValues","jumpStyles","length","jumpUp","moveBy","v2","easing","jumpDown","squash","scaleTo","stretch","scaleBack","callback","callFunc","playJumpSound","clearInterval","t","setInterval","runAction","repeat","sequence","audioEngine","playEffect","getCenterPos","centerPos","x","y","height","startMoveAt","setPosition","stopMove","stopAllActions","event","keyCode","macro","KEY","a","d","w","switchJumpStyle","s","touchLoc","getLocation","winSize","bool","changeJumpStyle","string","onDestroy","off","update","dt","Math","abs"],"mappings":"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","file":"Player.js","sourceRoot":"..\\..\\..\\..\\assets\\scripts","sourcesContent":["cc.Class({\n    extends: cc.Component,\n    \n    properties: {\n        initialHeight: 0,\n        // 主角跳跃高度\n        jumpHeight: 150,\n        // 主角跳跃持续时间\n        jumpDuration: 0.3,\n        // 辅助形变动作时间\n        squashDuration: 0,\n        // 最大移动速度\n        maxMoveSpeed: 3000,\n        // 加速度\n        accel: 250,\n        // 跳跃音效资源\n        jumpAudio: {\n            default: null,\n            type: cc.AudioClip\n        },\n\n        switchJumpStyleAudio: {\n            default: null,\n            type: cc.AudioClip\n        },\n\n        jumpInterval:null,\n\n        jumpStyleIndex:0,\n        jumpStylesLength:0,\n        // jumpStyle label 的引用\n        jumpStyleDisplay: {\n            default: null,\n            type: cc.Label\n        },\n    },\n    onLoad: function() {\n        this.enabled = false;\n\n        this.initProperties();\n\n        // 加速度方向开关\n        this.accLeft = false;\n        this.accRight = false;\n        // 主角当前水平方向速度\n        this.xSpeed = 0;\n\n        // screen boundaries\n        this.minPosX = -this.node.parent.width/2;\n        this.maxPosX = this.node.parent.width/2;\n\n\n        // 初始化键盘输入监听\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this);\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP, this.onKeyUp, this);\n\n        // 手机触摸屏\n        var touchReceiver = cc.Canvas.instance.node;\n        touchReceiver.on('touchstart', this.onTouchStart, this);\n        touchReceiver.on('touchend', this.onTouchEnd, this); \n    },\n\n    initProperties:function(){\n        this.initialHeight=0;\n        this.jumpHeight=150;\n        this.jumpDuration=0.3;\n        this.accel = 250;\n    },        \n\n    upgrade: function(){\n        this.jumpHeight += 2.5;\n        this.jumpDuration += 0.005;\n        this.accel += 25;\n        this.updateJumpAction();\n    },\n\n    getJumpStyles: function(r){\n\n        let styleKeys = [\n            // '起跳'\n            '正常',\n            '漂浮',\n            // '弹簧',\n            // '震动',\n            '二段',\n            '轻功',\n            '滞空'\n            // '悬空',\n            // '和谐',\n            \n        ];\n        let styleValues = [\n            // ['easeExponentialOut','easeExponentialIn'] //起跳\n            ['easeCubicActionOut','easeCubicActionIn']  //正常\n            ,['easeSineOut','easeSineIn'] //漂浮\n            // ,['easeElasticOut','easeElasticIn'] //弹簧\n            // ,['easeBounceOut','easeBounceIn'] //震动\n            ,['easeBackOut','easeBackIn'] //二段\n            ,['easeQuadraticActionOut','easeQuadraticActionIn']  //轻功\n            ,['easeQuarticActionOut','easeQuarticActionIn'] //滞空\n            // ,['easeQuinticActionOut','easeQuinticActionIn'] //悬空\n            // ,['easeCircleActionOut','easeCircleActionIn'] //和谐\n        ];\n\n        return r==='key'?styleKeys:styleValues;\n    },\n\n    updateJumpAction: function () {\n\n        let jumpStyles = this.getJumpStyles();\n        this.jumpStylesLength = jumpStyles.length;\n\n        // 上升\n        var jumpUp = cc.moveBy(this.jumpDuration, cc.v2(0, this.jumpHeight)).easing(cc[jumpStyles[this.jumpStyleIndex][0]]());\n        // 下落\n        var jumpDown = cc.moveBy(this.jumpDuration, cc.v2(0, -this.jumpHeight)).easing(cc[jumpStyles[this.jumpStyleIndex][1]]());\n        \n        // 形变\n        var squash = cc.scaleTo(this.squashDuration, 1, 0.6);\n        var stretch = cc.scaleTo(this.squashDuration, 1, 1.2);\n        var scaleBack = cc.scaleTo(this.squashDuration, 1, 1);\n\n        // 添加一个回调函数，用于在动作结束时调用我们定义的其他方法\n        var callback = cc.callFunc(this.playJumpSound, this);\n        clearInterval(this.jumpInterval);\n        let t = this;\n        this.jumpInterval = setInterval(function(){\n            t.node.runAction(cc.repeat(cc.sequence(squash, stretch, jumpUp, scaleBack, jumpDown, callback),1));\n        },this.jumpDuration *2000 + this.squashDuration*3000);\n    },\n\n    playJumpSound: function () {\n        // 调用声音引擎播放声音\n        cc.audioEngine.playEffect(this.jumpAudio, false);\n    },\n\n    getCenterPos: function () {\n        var centerPos = cc.v2(this.node.x, this.node.y + this.node.height/2);\n        return centerPos;\n    },\n\n    startMoveAt: function (x,y) {\n        this.enabled = true;\n        this.xSpeed = 0;\n        this.node.setPosition(x,y);\n        this.updateJumpAction();\n    },\n\n    stopMove: function () {\n        this.enabled = false;\n        this.node.stopAllActions();\n        clearInterval(this.jumpInterval);\n    },\n\n    onKeyDown (event) {\n        // set a flag when key pressed\n        switch(event.keyCode) {\n            case cc.macro.KEY.a:\n                this.accLeft = true;\n                break;\n            case cc.macro.KEY.d:\n                this.accRight = true;\n                break;\n            case cc.macro.KEY.w:\n                this.switchJumpStyle(true);\n                break;\n            case cc.macro.KEY.s:\n                this.switchJumpStyle(false);\n                break;\n        }\n    },\n\n    onKeyUp (event) {\n        // unset a flag when key released\n        switch(event.keyCode) {\n            case cc.macro.KEY.a:\n                this.accLeft = false;\n                break;\n            case cc.macro.KEY.d:\n                this.accRight = false;\n                break;\n        }\n    },\n\n    onTouchStart (event) {\n        var touchLoc = event.getLocation();\n        if (touchLoc.x > cc.winSize.width/2) {\n            if(touchLoc.y > cc.winSize.height/2){\n                this.switchJumpStyle(true);\n            }else{\n                this.accLeft = false;\n                this.accRight = true;\n            }\n        } else {\n            if(touchLoc.y > cc.winSize.height/2){\n                this.switchJumpStyle(false);\n            }else{\n                this.accLeft = true;\n                this.accRight = false;\n            }\n        }\n    },\n\n    switchJumpStyle:function(bool){\n        if(bool){\n            if(this.jumpStyleIndex === this.jumpStylesLength-1){\n                this.jumpStyleIndex = 0;\n            }else{\n                this.jumpStyleIndex++;\n            }\n        }else{\n            if(this.jumpStyleIndex===0){\n                this.jumpStyleIndex = this.jumpStylesLength-1;\n            }else{\n                this.jumpStyleIndex--;\n            }\n        }\n        this.updateJumpAction();\n        this.changeJumpStyle();\n    },\n\n    changeJumpStyle: function(){\n        let jumpStyles = this.getJumpStyles('key');\n        this.jumpStyleDisplay.string = '跳跃模式: ' + jumpStyles[this.jumpStyleIndex];\n\n        // 播放切换武器的声音\n        cc.audioEngine.playEffect(this.switchJumpStyleAudio, false);\n    },\n    \n    onTouchEnd (event) {\n        this.accLeft = false;\n        this.accRight = false;\n    },\n\n    onDestroy () {\n        // 取消键盘输入监听\n        cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this);\n        cc.systemEvent.off(cc.SystemEvent.EventType.KEY_UP, this.onKeyUp, this);\n       \n        var touchReceiver = cc.Canvas.instance.node;\n        touchReceiver.off('touchstart', this.onTouchStart, this);\n        touchReceiver.off('touchend', this.onTouchEnd, this);\n    },    \n\n    update: function (dt) {\n        // 根据当前加速度方向每帧更新速度\n        if (this.accLeft) {\n            this.xSpeed -= this.accel * dt;\n        } else if (this.accRight) {\n            this.xSpeed += this.accel * dt;\n        }\n        // 限制主角的速度不能超过最大值\n        if ( Math.abs(this.xSpeed) > this.maxMoveSpeed ) {\n            // if speed reach limit, use max speed with current direction\n            this.xSpeed = this.maxMoveSpeed * this.xSpeed / Math.abs(this.xSpeed);\n        }\n\n        // 根据当前速度更新主角的位置\n        this.node.x += this.xSpeed * dt;\n\n        // limit player position inside screen\n        if ( this.node.x > this.node.parent.width/2) {\n            this.node.x = this.node.parent.width/2;\n            this.xSpeed = 0;\n        } else if (this.node.x < -this.node.parent.width/2) {\n            this.node.x = -this.node.parent.width/2;\n            this.xSpeed = 0;\n        }\n    },\n\n});\n\n\n"]}